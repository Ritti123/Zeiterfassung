<!DOCTYPE html>
<html lang="de">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <meta name="apple-mobile-web-app-capable" content="yes">
Â  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
Â  <meta name="theme-color" content="#3498db">
Â  <title>Zeiterfassung</title>
Â  <link rel="manifest" href="/manifest.json">
Â  <link rel="apple-touch-icon" href="icons/icon-192x192.png">
Â  <style>
Â  Â  :root {
Â  Â  Â  --bg-color: #f4f6f8;
Â  Â  Â  --text-color: #333;
Â  Â  Â  --section-bg: #fff;
Â  Â  Â  --border-color: #ddd;
Â  Â  Â  --button-primary: #3498db;
Â  Â  Â  --button-danger: #e74c3c;
Â  Â  Â  --button-success: #2ecc71;
Â  Â  Â  --shadow: 0 1px 3px rgba(0,0,0,0.1);
Â  Â  Â  --input-border: #ccc;
Â  Â  Â  --stat-bg: #fff;
Â  Â  }

Â  Â  [data-theme="dark"] {
Â  Â  Â  --bg-color: #1a1a1a;
Â  Â  Â  --text-color: #f0f0f0;
Â  Â  Â  --section-bg: #2d2d2d;
Â  Â  Â  --border-color: #444;
Â  Â  Â  --button-primary: #2980b9;
Â  Â  Â  --button-danger: #c0392b;
Â  Â  Â  --button-success: #27ae60;
Â  Â  Â  --shadow: 0 1px 3px rgba(0,0,0,0.3);
Â  Â  Â  --input-border: #555;
Â  Â  Â  --stat-bg: #3d3d3d;
Â  Â  }

Â  Â  body {
Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
Â  Â  Â  max-width: 700px;
Â  Â  Â  margin: 0 auto;
Â  Â  Â  padding: 20px;
Â  Â  Â  background: var(--bg-color);
Â  Â  Â  color: var(--text-color);
Â  Â  Â  transition: all 0.3s ease;
Â  Â  Â  -webkit-tap-highlight-color: transparent;
Â  Â  }
Â  Â  h2, h3, h4 { margin-top: 0; }
Â  Â  .section {
Â  Â  Â  background: var(--section-bg);
Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  padding: 20px;
Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  box-shadow: var(--shadow);
Â  Â  }
Â  Â  input, select, button {
Â  Â  Â  padding: 10px;
Â  Â  Â  margin: 10px 0;
Â  Â  Â  width: 100%;
Â  Â  Â  box-sizing: border-box;
Â  Â  Â  border: 1px solid var(--input-border);
Â  Â  Â  border-radius: 6px;
Â  Â  Â  font-size: 16px;
Â  Â  Â  background: var(--section-bg);
Â  Â  Â  color: var(--text-color);
Â  Â  }
Â  Â  input::placeholder { color: #aaa; }
Â  Â  button {
Â  Â  Â  background-color: var(--button-primary);
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  Â  cursor: pointer;
Â  Â  Â  font-weight: bold;
Â  Â  Â  -webkit-appearance: none;
Â  Â  }
Â  Â  button.delete { background-color: var(--button-danger); }
Â  Â  button.secondary { background-color: var(--button-success); }
Â  Â  table {
Â  Â  Â  width: 100%;
Â  Â  Â  border-collapse: collapse;
Â  Â  Â  margin-top: 20px;
Â  Â  Â  background-color: var(--section-bg);
Â  Â  }
Â  Â  th, td {
Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  padding: 8px;
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  th { background-color: var(--stat-bg); }
Â  Â  .stats {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 10px;
Â  Â  Â  margin-top: 20px;
Â  Â  }
Â  Â  .stat-box {
Â  Â  Â  flex: 1;
Â  Â  Â  min-width: 140px;
Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  padding: 10px;
Â  Â  Â  border-radius: 5px;
Â  Â  Â  background-color: var(--stat-bg);
Â  Â  }
Â  Â  .settings { margin-top: 20px; }
Â  Â  .theme-toggle {
Â  Â  Â  position: fixed;
Â  Â  Â  top: 10px;
Â  Â  Â  right: 10px;
Â  Â  Â  width: 40px;
Â  Â  Â  height: 40px;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  background: var(--button-primary);
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  Â  cursor: pointer;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  z-index: 100;
Â  Â  }
Â  Â  .install-btn {
Â  Â  Â  position: fixed;
Â  Â  Â  top: 60px;
Â  Â  Â  right: 10px;
Â  Â  Â  width: 40px;
Â  Â  Â  height: 40px;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  background: var(--button-success);
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  Â  cursor: pointer;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  z-index: 100;
Â  Â  Â  display: none;
Â  Â  }
Â  Â  @media (max-width: 600px) {
Â  Â  Â  .stat-box { min-width: 100%; }
Â  Â  Â  table { font-size: 14px; }
Â  Â  Â  th, td { padding: 5px; }
Â  Â  }
Â  Â  @media (display-mode: standalone) {
Â  Â  Â  body {
Â  Â  Â  Â  padding-top: 20px;
Â  Â  Â  }
Â  Â  }
Â  </style>
</head>
<body>
Â  <button class="theme-toggle" id="theme-toggle">ðŸŒ“</button>
Â  <button class="install-btn" id="install-btn">ðŸ“²</button>

Â  <div class="section">
Â  Â  <h2>Zeiterfassung</h2>

Â  Â  <div class="settings">
Â  Â  Â  <label for="work-hours">TÃ¤gliche Sollstunden:</label>
Â  Â  Â  <input type="number" id="work-hours" min="1" max="24" value="8">

Â  Â  Â  <label for="vacation-days-year">JÃ¤hrliche Urlaubstage:</label>
Â  Â  Â  <input type="number" id="vacation-days-year" min="1" max="365" value="24">

Â  Â  Â  <label for="carryover-days">Resturlaub Vorjahr:</label>
Â  Â  Â  <input type="number" id="carryover-days" min="0" value="0">
Â  Â  </div>

Â  Â  <div>
Â  Â  Â  <label for="date">Datum:</label>
Â  Â  Â  <input type="date" id="date">
Â  Â  </div>
Â  Â  <div>
Â  Â  Â  <label for="start-time">Kommen:</label>
Â  Â  Â  <input type="time" id="start-time" placeholder="z.&#8239;B. 08:00" pattern="[0-9]{2}:[0-9]{2}">
Â  Â  </div>
Â  Â  <div>
Â  Â  Â  <label for="end-time">Gehen:</label>
Â  Â  Â  <input type="time" id="end-time" placeholder="z.&#8239;B. 16:30" pattern="[0-9]{2}:[0-9]{2}">
Â  Â  </div>
Â  Â  <div>
Â  Â  Â  <label for="break">Pause (Minuten):</label>
Â  Â  Â  <input type="number" id="break" value="30" placeholder="z.&#8239;B. 30" min="0" max="240">
Â  Â  </div>
Â  Â  <div>
Â  Â  Â  <label for="type">Art:</label>
Â  Â  Â  <select id="type">
Â  Â  Â  Â  <option value="Arbeit">Arbeit</option>
Â  Â  Â  Â  <option value="Urlaub">Urlaub</option>
Â  Â  Â  Â  <option value="Krank">Krank</option>
Â  Â  Â  Â  <option value="Feiertag">Feiertag</option>
Â  Â  Â  </select>
Â  Â  </div>
Â  Â  <button id="add-entry-btn">Eintrag hinzufÃ¼gen</button>

Â  Â  <div id="time-range" style="display: none;">
Â  Â  Â  <label for="end-date">Bis Datum:</label>
Â  Â  Â  <input type="date" id="end-date">
Â  Â  Â  <button id="add-time-range-btn">Zeitraum hinzufÃ¼gen</button>
Â  Â  </div>

Â  Â  <div>
Â  Â  Â  <label for="month">Monat anzeigen:</label>
Â  Â  Â  <input type="month" id="month">
Â  Â  </div>

Â  Â  <h3 id="report-title">Monatsreport</h3>
Â  Â  <div style="overflow-x: auto;">
Â  Â  Â  <table id="time-entries">
Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  <th>Datum</th>
Â  Â  Â  Â  Â  Â  <th>Kommen</th>
Â  Â  Â  Â  Â  Â  <th>Gehen</th>
Â  Â  Â  Â  Â  Â  <th>Pause</th>
Â  Â  Â  Â  Â  Â  <th>Art</th>
Â  Â  Â  Â  Â  Â  <th>Stunden</th>
Â  Â  Â  Â  Â  Â  <th>Soll</th>
Â  Â  Â  Â  Â  Â  <th>Differenz</th>
Â  Â  Â  Â  Â  Â  <th>Aktion</th>
Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  </thead>
Â  Â  Â  Â  <tbody></tbody>
Â  Â  Â  </table>
Â  Â  </div>

Â  Â  <div class="stats">
Â  Â  Â  <div class="stat-box">
Â  Â  Â  Â  <h4>Ãœberstunden</h4>
Â  Â  Â  Â  <p id="overtime">0:00</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="stat-box">
Â  Â  Â  Â  <h4>Urlaubstage</h4>
Â  Â  Â  Â  <p id="vacation-days">0 Tage (verfÃ¼gbar: 24)</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="stat-box">
Â  Â  Â  Â  <h4>Krankheitstage</h4>
Â  Â  Â  Â  <p id="sick-days">0 Tage</p>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <button id="export-csv-btn" class="secondary">CSV exportieren</button>
Â  Â  <button id="export-pdf-btn" class="secondary">PDF exportieren</button>
Â  Â  <button id="export-backup-btn" class="secondary">Backup speichern</button>
Â  Â  <button id="import-backup-btn">Backup laden</button>
Â  Â  <input type="file" id="import-file" style="display:none">
Â  Â  <button id="reset-overtime-btn" class="delete">Ãœberstunden zurÃ¼cksetzen</button>
Â  </div>

Â  <script>
Â  Â  // Kein IndexedDB, wir verwenden localStorage
Â  Â  let timeEntries = JSON.parse(localStorage.getItem('timeEntries') || '[]');
Â  Â  let totalOvertimeMinutes = parseInt(localStorage.getItem('totalOvertimeMinutes') || 0);
Â  Â  const tbody = document.querySelector('#time-entries tbody');
Â  Â  const overtimeDisplay = document.getElementById('overtime');
Â  Â  const vacationDaysDisplay = document.getElementById('vacation-days');
Â  Â  const sickDaysDisplay = document.getElementById('sick-days');
Â  Â  const workHoursInput = document.getElementById('work-hours');
Â  Â  const vacationDaysYearInput = document.getElementById('vacation-days-year');
Â  Â  const carryoverDaysInput = document.getElementById('carryover-days');
Â  Â  const monthInput = document.getElementById('month');
Â  Â  const reportTitle = document.getElementById('report-title');
Â  Â  const timeRangeDiv = document.getElementById('time-range');
Â  Â  const addTimeRangeBtn = document.getElementById('add-time-range-btn');
Â  Â  const installBtn = document.getElementById('install-btn');
Â  Â  const backupTimestamps = JSON.parse(localStorage.getItem('backupTimestamps') || '[]');
Â  Â  const resetOvertimeBtn = document.getElementById('reset-overtime-btn');

Â  Â  // Datum auf heute setzen beim Laden
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  document.getElementById('date').valueAsDate = new Date();
Â  Â  Â  const now = new Date();
Â  Â  Â  const year = now.getFullYear();
Â  Â  Â  const month = String(now.getMonth() + 1).padStart(2, '0');
Â  Â  Â  monthInput.value = `${year}-${month}`;
Â  Â  Â  loadSettings();
Â  Â  Â  loadEntries();
Â  Â  Â  checkBackupReminder();

Â  Â  Â  if (window.matchMedia('(display-mode: standalone)').matches) {
Â  Â  Â  Â  console.log('LÃ¤uft als Standalone-App');
Â  Â  Â  }

Â  Â  Â  let deferredPrompt;
Â  Â  Â  window.addEventListener('beforeinstallprompt', (e) => {
Â  Â  Â  Â  console.log('beforeinstallprompt Event wurde ausgelÃ¶st');
Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  deferredPrompt = e;
Â  Â  Â  Â  installBtn.style.display = 'flex';

Â  Â  Â  Â  installBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  deferredPrompt.prompt();
Â  Â  Â  Â  Â  deferredPrompt.userChoice.then((choiceResult) => {
Â  Â  Â  Â  Â  Â  if (choiceResult.outcome === 'accepted') {
Â  Â  Â  Â  Â  Â  Â  console.log('User accepted the A2HS prompt');
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  console.log('User dismissed the A2HS prompt');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  deferredPrompt = null;
Â  Â  Â  Â  Â  Â  installBtn.style.display = 'none';
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });
Â  Â  Â  });

Â  Â  Â  window.addEventListener('appinstalled', (evt) => {
Â  Â  Â  Â  console.log('PWA wurde installiert.');
Â  Â  Â  Â  installBtn.style.display = 'none';
Â  Â  Â  });
Â  Â  });

Â  Â  // Einstellungen laden
Â  Â  function loadSettings() {
Â  Â  Â  workHoursInput.value = localStorage.getItem('workHours') || '8';
Â  Â  Â  vacationDaysYearInput.value = localStorage.getItem('vacationDays') || '24';
Â  Â  Â  carryoverDaysInput.value = localStorage.getItem('carryoverDays') || '0';
Â  Â  Â  const savedTheme = localStorage.getItem('theme');
Â  Â  Â  if (savedTheme) {
Â  Â  Â  Â  document.documentElement.setAttribute('data-theme', savedTheme);
Â  Â  Â  Â  if (savedTheme === 'dark') {
Â  Â  Â  Â  Â  document.getElementById('theme-toggle').textContent = 'â˜€ï¸';
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }

Â  Â  // Einstellungen speichern
Â  Â  function saveSettings() {
Â  Â  Â  localStorage.setItem('workHours', workHoursInput.value);
Â  Â  Â  localStorage.setItem('vacationDays', vacationDaysYearInput.value);
Â  Â  Â  localStorage.setItem('carryoverDays', carryoverDaysInput.value);
Â  Â  Â  loadEntries(); // Nach dem Speichern neu laden, um Urlaubstage zu aktualisieren
Â  Â  }

Â  Â  // Daten aus localStorage laden
Â  Â  function loadEntries() {
Â  Â  Â  const selectedMonth = monthInput.value;
Â  Â  Â  const [year, month] = selectedMonth.split("-");
Â  Â  Â  const monthNames = ['Januar', 'Februar', 'MÃ¤rz', 'April', 'Mai', 'Juni',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'];
Â  Â  Â  reportTitle.textContent = `Monatsreport ${monthNames[parseInt(month)-1]} ${year}`;

Â  Â  Â  timeEntries = JSON.parse(localStorage.getItem('timeEntries') || '[]');
Â  Â  Â  totalOvertimeMinutes = parseInt(localStorage.getItem('totalOvertimeMinutes') || 0);
Â  Â  Â  // EintrÃ¤ge nach Datum sortieren
Â  Â  Â  timeEntries.sort((a, b) => new Date(a.date) - new Date(b.date));
Â  Â  Â  renderEntries(year);
Â  Â  }

Â  Â  // Eintrag speichern (localStorage)
Â  Â  function saveEntry(entry) {
Â  Â  Â  entry.id = Date.now();
Â  Â  Â  timeEntries.push(entry);
Â  Â  Â  localStorage.setItem('timeEntries', JSON.stringify(timeEntries));
Â  Â  Â  return Promise.resolve();
Â  Â  }

Â  Â  // EintrÃ¤ge rendern
Â  Â  function renderEntries(currentYear) {
Â  Â  Â  tbody.innerHTML = '';
Â  Â  Â  let monthlyOvertimeMinutes = 0;
Â  Â  Â  let vacationDaysTaken = 0;
Â  Â  Â  let sickDaysTaken = 0;
Â  Â  Â  let holidayDaysTaken = 0;

Â  Â  Â  const selectedMonth = monthInput.value;
Â  Â  Â  const entries = timeEntries
Â  Â  Â  Â  .filter(e => e.date && e.date.startsWith(selectedMonth))
Â  Â  Â  Â  .sort((a, b) => new Date(a.date) - new Date(b.date));

Â  Â  Â  const annualVacationDays = parseInt(localStorage.getItem('vacationDays') || 24);
Â  Â  Â  const carryoverDays = parseInt(localStorage.getItem('carryoverDays') || 0);
Â  Â  Â  let availableVacationDays = annualVacationDays + carryoverDays;

Â  Â  Â  // JahresÃ¼bergreifende Urlaubstage zÃ¤hlen
Â  Â  Â  timeEntries.forEach(entry => {
Â  Â  Â  Â  if (entry.type === 'Urlaub') {
Â  Â  Â  Â  Â  vacationDaysTaken++;
Â  Â  Â  Â  } else if (entry.type === 'Krank') {
Â  Â  Â  Â  Â  sickDaysTaken++;
Â  Â  Â  Â  } else if (entry.type === 'Feiertag') {
Â  Â  Â  Â  Â  holidayDaysTaken++;
Â  Â  Â  Â  }
Â  Â  Â  });

Â  Â  Â  entries.forEach(entry => {
Â  Â  Â  Â  const row = tbody.insertRow();
Â  Â  Â  Â  row.insertCell(0).textContent = formatDate(entry.date);
Â  Â  Â  Â  row.insertCell(1).textContent = entry.type === 'Arbeit' ? entry.start || '-' : '-';
Â  Â  Â  Â  row.insertCell(2).textContent = entry.type === 'Arbeit' ? entry.end || '-' : '-';
Â  Â  Â  Â  row.insertCell(3).textContent = entry.type === 'Arbeit' ? entry.pause || 0 : '-';
Â  Â  Â  Â  row.insertCell(4).textContent = entry.type;
Â  Â  Â  Â  row.insertCell(5).textContent = entry.hours || '0:00';

Â  Â  Â  Â  let istMin = 0;
Â  Â  Â  Â  if (entry.type === 'Arbeit') {
Â  Â  Â  Â  Â  const [h, m] = (entry.hours || '0:00').split(":").map(Number);
Â  Â  Â  Â  Â  istMin = h * 60 + m;
Â  Â  Â  Â  Â  const sollMin = entry.sollHours ? entry.sollHours * 60 : parseFloat(localStorage.getItem('workHours') || 8) * 60;
Â  Â  Â  Â  Â  monthlyOvertimeMinutes += istMin - sollMin;
Â  Â  Â  Â  }

Â  Â  Â  Â  const sollHours = entry.sollHours ? entry.sollHours : parseFloat(localStorage.getItem('workHours') || 8);
Â  Â  Â  Â  row.insertCell(6).textContent = entry.type === 'Arbeit'
Â  Â  Â  Â  Â  ? `${Math.floor(sollHours)}:${String(Math.round((sollHours % 1) * 60)).padStart(2, '0')}`
Â  Â  Â  Â  Â  : '-';

Â  Â  Â  Â  let diff = istMin - (sollHours * 60);
Â  Â  Â  Â  row.insertCell(7).textContent = entry.type === 'Arbeit'
Â  Â  Â  Â  Â  ? `${diff < 0 ? '-' : ''}${Math.floor(Math.abs(diff) / 60)}:${String(Math.abs(diff) % 60).padStart(2, '0')}`
Â  Â  Â  Â  Â  : '-';

Â  Â  Â  Â  const deleteBtn = document.createElement('button');
Â  Â  Â  Â  deleteBtn.textContent = 'LÃ¶schen';
Â  Â  Â  Â  deleteBtn.className = 'delete';
Â  Â  Â  Â  deleteBtn.onclick = () => deleteEntry(entry.id);
Â  Â  Â  Â  row.insertCell(8).appendChild(deleteBtn);
Â  Â  Â  });

Â  Â  Â  // GesamtÃ¼berstunden aktualisieren
Â  Â  Â  totalOvertimeMinutes += monthlyOvertimeMinutes;
Â  Â  Â  localStorage.setItem('totalOvertimeMinutes', totalOvertimeMinutes);
Â  Â  Â  updateStats(totalOvertimeMinutes, vacationDaysTaken, annualVacationDays + carryoverDays, sickDaysTaken);
Â  Â  }

Â  Â  // Eintrag lÃ¶schen (localStorage)
Â  Â  function deleteEntry(id) {
Â  Â  Â  if (!confirm("Eintrag wirklich lÃ¶schen?")) return;

Â  Â  Â  const deletedEntry = timeEntries.find(e => e.id === id);
Â  Â  Â  if (deletedEntry && deletedEntry.type === 'Arbeit' && deletedEntry.hours) {
Â  Â  Â  Â  const [h, m] = deletedEntry.hours.split(':').map(Number);
Â  Â  Â  Â  totalOvertimeMinutes -= (h * 60 + m) - (deletedEntry.sollHours ? deletedEntry.sollHours * 60 : parseFloat(localStorage.getItem('workHours') || 8) * 60);
Â  Â  Â  Â  localStorage.setItem('totalOvertimeMinutes', totalOvertimeMinutes);
Â  Â  Â  }
Â  Â  Â  timeEntries = timeEntries.filter(e => e.id !== id);
Â  Â  Â  localStorage.setItem('timeEntries', JSON.stringify(timeEntries));
Â  Â  Â  loadEntries();
Â  Â  }

Â  Â  // Eintrag hinzufÃ¼gen
Â  Â  async function addTimeEntry() {
Â  Â  Â  const date = document.getElementById('date').value;
Â  Â  Â  const start = document.getElementById('start-time').value;
Â  Â  Â  const end = document.getElementById('end-time').value;
Â  Â  Â  const pause = parseInt(document.getElementById('break').value) || 0;
Â  Â  Â  const type = document.getElementById('type').value;
Â  Â  Â  const sollHours = parseFloat(workHoursInput.value);

Â  Â  Â  if (!date) {
Â  Â  Â  Â  alert('Bitte Datum ausfÃ¼llen.');
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  // PrÃ¼fen auf doppelten Eintrag
Â  Â  Â  const existingEntry = timeEntries.find(e => e.date === date);
Â  Â  Â  if (existingEntry) {
Â  Â  Â  Â  if (!confirm("FÃ¼r dieses Datum existiert bereits ein Eintrag. Ãœberschreiben?")) return;
Â  Â  Â  Â  deleteEntry(existingEntry.id);
Â  Â  Â  }

Â  Â  Â  // Validierung der Zeiten
Â  Â  Â  if (type === 'Arbeit') {
Â  Â  Â  Â  if (!start || !end) {
Â  Â  Â  Â  Â  alert('Bitte Start- und Endzeit fÃ¼r Arbeitstage ausfÃ¼llen.');
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  if (!isValidTime(start) || !isValidTime(end)) {
Â  Â  Â  Â  Â  alert('UngÃ¼ltige Zeitangabe. Bitte im Format HH:MM eingeben (z.B. 08:30).');
Â  Â  Â  Â  Â  return;
            }

Â  Â  Â  Â  const startDate = new Date(`${date}T${start}`);
Â  Â  Â  Â  const endDate = new Date(`${date}T${end}`);
Â  Â  Â  Â  const diff = (endDate - startDate) / 60000 - pause;

Â  Â  Â  Â  if (diff <= 0) {
Â  Â  Â  Â  Â  alert('Endzeit muss nach Startzeit liegen.');
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  if (diff > 16 * 60) {
Â  Â  Â  Â  Â  if (!confirm(`Arbeitszeit von ${Math.floor(diff/60)} Stunden und ${Math.round(diff%60)} Minuten ist sehr lang. Trotzdem speichern?`)) {
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  if (pause < 0 || pause > 240) {
Â  Â  Â  Â  alert('Pausenzeit muss zwischen 0 und 240 Minuten liegen.');
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  const entry = {
Â  Â  Â  Â  date,
Â  Â  Â  Â  type,
Â  Â  Â  Â  hours: '0:00',
Â  Â  Â  Â  pause: type === 'Arbeit' ? pause : 0,
Â  Â  Â  Â  sollHours: sollHours
Â  Â  Â  };

Â  Â  Â  if (type === 'Arbeit') {
Â  Â  Â  Â  const startDate = new Date(`${date}T${start}`);
Â  Â  Â  Â  const endDate = new Date(`${date}T${end}`);
Â  Â  Â  Â  const diff = (endDate - startDate) / 60000 - pause;
Â  Â  Â  Â  const h = Math.floor(diff / 60);
Â  Â  Â  Â  const m = Math.round(diff % 60);
Â  Â  Â  Â  entry.hours = `${h}:${m.toString().padStart(2, '0')}`;
Â  Â  Â  Â  entry.start = start;
Â  Â  Â  Â  entry.end = end;
Â  Â  Â  }

Â  Â  Â  await saveEntry(entry);
Â  Â  Â  // Nach dem Speichern die EintrÃ¤ge neu laden und sortieren
Â  Â  Â  loadEntries();
Â  Â  Â  resetForm();
Â  Â  }

Â  Â  // Zeitraum hinzufÃ¼gen (fÃ¼r Urlaub/Krank/Feiertag)
Â  Â  async function addTimeRange() {
Â  Â  Â  const startDate = document.getElementById('date').value;
Â  Â  Â  const endDate = document.getElementById('end-date').value;
Â  Â  Â  const type = document.getElementById('type').value;

Â  Â  Â  if (!startDate || !endDate) {
Â  Â  Â  Â  alert('Bitte Start- und Enddatum ausfÃ¼llen.');
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  if (new Date(endDate) < new Date(startDate)) {
Â  Â  Â  Â  alert('Enddatum muss nach Startdatum liegen.');
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  if (!confirm(`${type}-Zeitraum vom ${formatDate(startDate)} bis ${formatDate(endDate)} hinzufÃ¼gen?`)) {
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  // PrÃ¼fen auf bestehende EintrÃ¤ge im Zeitraum
Â  Â  Â  const existingEntries = timeEntries.filter(e => {
Â  Â  Â  Â  const entryDate = new Date(e.date);
Â  Â  Â  Â  return entryDate >= new Date(startDate) && entryDate <= new Date(endDate);
Â  Â  Â  });

Â  Â  Â  if (existingEntries.length > 0) {
Â  Â  Â  Â  if (!confirm(`${existingEntries.length} bestehende EintrÃ¤ge im Zeitraum werden Ã¼berschrieben. Fortfahren?`)) {
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  // LÃ¶sche bestehende EintrÃ¤ge
Â  Â  Â  Â  existingEntries.forEach(entry => deleteEntry(entry.id));
Â  Â  Â  }

Â  Â  Â  const currentDate = new Date(startDate);
Â  Â  Â  const end = new Date(endDate);

Â  Â  Â  while (currentDate <= end) {
Â  Â  Â  Â  const dateStr = currentDate.toISOString().split('T')[0];
Â  Â  Â  Â  const entry = {
Â  Â  Â  Â  Â  date: dateStr,
Â  Â  Â  Â  Â  type,
Â  Â  Â  Â  Â  hours: '0:00',
Â  Â  Â  Â  Â  sollHours: parseFloat(workHoursInput.value)
Â  Â  Â  Â  };
Â  Â  Â  Â  await saveEntry(entry);
Â  Â  Â  Â  currentDate.setDate(currentDate.getDate() + 1);
Â  Â  Â  }

Â  Â  Â  // Nach dem HinzufÃ¼gen des Zeitraums die EintrÃ¤ge neu laden und sortieren
Â  Â  Â  loadEntries();
Â  Â  Â  resetForm();
Â  Â  Â  timeRangeDiv.style.display = 'none';
Â  Â  }

Â  Â  // Formular zurÃ¼cksetzen
Â  Â  function resetForm() {
Â  Â  Â  document.getElementById('start-time').value = '';
Â  Â  Â  document.getElementById('end-time').value = '';
Â  Â  Â  document.getElementById('break').value = '30';
Â  Â  Â  const nextDay = new Date(new Date(document.getElementById('date').value).getTime() + 86400000);
Â  Â  Â  document.getElementById('date').valueAsDate = new Date(nextDay);
Â  Â  Â  document.getElementById('end-date').value = '';
Â  Â  }

Â  Â  // Statistik aktualisieren
Â  Â  function updateStats(overtimeMinutes, vacationTaken, vacationTotal, sickDays) {
Â  Â  Â  const oh = Math.floor(Math.abs(overtimeMinutes) / 60);
Â  Â  Â  const om = Math.abs(overtimeMinutes) % 60;
Â  Â  Â  const sign = overtimeMinutes < 0 ? "-" : "";
Â  Â  Â  overtimeDisplay.textContent = `${sign}${oh}:${String(om).padStart(2, '0')}`;

Â  Â  Â  const remainingVacation = vacationTotal - vacationTaken;
Â  Â  Â  vacationDaysDisplay.textContent = `${vacationTaken} Tage (verfÃ¼gbar: ${remainingVacation})`;

Â  Â  Â  sickDaysDisplay.textContent = `${sickDays} Tage`;
Â  Â  }

Â  Â  // Theme umschalten
Â  Â  function toggleTheme() {
Â  Â  Â  const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
Â  Â  Â  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
Â  Â  Â  document.documentElement.setAttribute('data-theme', newTheme);
Â  Â  Â  localStorage.setItem('theme', newTheme);
Â  Â  }

Â  Â  // CSV Export
Â  Â  function exportCSV() {
Â  Â  Â  const selectedMonth = monthInput.value;
Â  Â  Â  const [year, month] = selectedMonth.split("-");
Â  Â  Â  const monthNames = ['Januar', 'Februar', 'MÃ¤rz', 'April', 'Mai', 'Juni',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'];

Â  Â  Â  // EintrÃ¤ge filtern und nach Datum sortieren
Â  Â  Â  const entries = timeEntries
Â  Â  Â  Â  .filter(e => e.date && e.date.startsWith(selectedMonth))
Â  Â  Â  Â  .sort((a, b) => new Date(a.date) - new Date(b.date));

Â  Â  Â  if (entries.length === 0) return alert('Keine Daten vorhanden.');

Â  Â  Â  let csv = `Monatsreport ${monthNames[parseInt(month)-1]} ${year}\nDatum;Kommen;Gehen;Pause;Art;Stunden;Sollstunden;Differenz\n`;
Â  Â  Â  entries.forEach(e => {
Â  Â  Â  Â  const sollHours = e.sollHours ? e.sollHours : parseFloat(localStorage.getItem('workHours') || 8);
Â  Â  Â  Â  let diff = '';

Â  Â  Â  Â  if (e.type === 'Arbeit') {
Â  Â  Â  Â  Â  const [h, m] = (e.hours || '0:00').split(":").map(Number);
Â  Â  Â  Â  Â  const istMin = h * 60 + m;
Â  Â  Â  Â  Â  const sollMin = sollHours * 60;
Â  Â  Â  Â  Â  const diffMin = istMin - sollMin;
Â  Â  Â  Â  Â  const sign = diffMin < 0 ? '-' : '';
Â  Â  Â  Â  Â  diff = `${sign}${Math.floor(Math.abs(diffMin) / 60)}:${String(Math.abs(diffMin) % 60).padStart(2, '0')}`;
Â  Â  Â  Â  }

Â  Â  Â  Â  csv += `${formatDate(e.date)};${e.type === 'Arbeit' ? e.start || '' : ''};${e.type === 'Arbeit' ? e.end || '' : ''};${e.type === 'Arbeit' ? e.pause : ''};${e.type};${e.hours || '0:00'};${e.type === 'Arbeit' ? sollHours : ''};${diff}\n`;
Â  Â  Â  });

Â  Â  Â  const oh = Math.floor(Math.abs(totalOvertimeMinutes) / 60);
Â  Â  Â  const om = Math.abs(totalOvertimeMinutes) % 60;
Â  Â  Â  const sign = totalOvertimeMinutes < 0 ? "-" : "";
Â  Â  Â  const overtime = `${sign}${oh}:${String(om).padStart(2, '0')}`; // Hier wird 'overtime' initialisiert
Â  Â  Â  const vacationTotal = parseInt(localStorage.getItem('vacationDays') || 24) + parseInt(localStorage.getItem('carryoverDays') || 0);
Â  Â  Â  const vacationTaken = timeEntries.filter(e => e.type === 'Urlaub').length;
Â  Â  Â  const sickDays = timeEntries.filter(e => e.type === 'Krank').length;

Â  Â  Â  csv += `\nÃœberstunden:;${overtime}\nUrlaubstage (genommen/verfÃ¼gbar):;${vacationTaken}/${vacationTotal}\nKrankheitstage:;${sickDays}\n`;

Â  Â  Â  download(`Monatsreport_${monthNames[parseInt(month)-1]}_${year}.csv`, csv, 'text/csv');
Â  Â  }

Â  Â  // PDF Export
Â  Â  function exportPDF() {
Â  Â  Â  const selectedMonth = monthInput.value;
Â  Â  Â  const [year, month] = selectedMonth.split("-");
Â  Â  Â  const monthNames = ['Januar', 'Februar', 'MÃ¤rz', 'April', 'Mai', 'Juni',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'];

Â  Â  Â  // EintrÃ¤ge filtern und nach Datum sortieren
Â  Â  Â  const entries = timeEntries
Â  Â  Â  Â  .filter(e => e.date && e.date.startsWith(selectedMonth))
Â  Â  Â  Â  .sort((a, b) => new Date(a.date) - new Date(b.date));

Â  Â  Â  if (entries.length === 0) {
Â  Â  Â  Â  alert('Keine EintrÃ¤ge fÃ¼r den ausgewÃ¤hlten Monat vorhanden!');
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  try {
Â  Â  Â  Â  const doc = new window.jspdf.jsPDF('portrait');

Â  Â  Â  Â  // Titel
Â  Â  Â  Â  doc.setFontSize(16);
Â  Â  Â  Â  doc.text(`Monatsreport ${monthNames[parseInt(month)-1]} ${year}`, 105, 15, { align: 'center' });

Â  Â  Â  Â  // Tabellenkopf
Â  Â  Â  Â  const headers = ["Datum", "Kommen", "Gehen", "Pause", "Art", "Stunden", "Sollstunden", "Differenz"];
Â  Â  Â  Â  let data = [];

Â  Â  Â  Â  // Tabellendaten
Â  Â  Â  Â  entries.forEach(e => {
Â  Â  Â  Â  Â  const sollHours = e.type === 'Arbeit' ? (e.sollHours ? e.sollHours : parseFloat(localStorage.getItem('workHours') || 8)) : '';
Â  Â  Â  Â  Â  let diff = '';

Â  Â  Â  Â  Â  if (e.type === 'Arbeit') {
Â  Â  Â  Â  Â  Â  const [h, m] = (e.hours || '0:00').split(":").map(Number);
Â  Â  Â  Â  Â  Â  const istMin = h * 60 + m;
Â  Â  Â  Â  Â  Â  const sollMin = sollHours * 60;
Â  Â  Â  Â  Â  Â  const diffMin = istMin - sollMin;
Â  Â  Â  Â  Â  Â  const sign = diffMin < 0 ? '-' : '';
Â  Â  Â  Â  Â  Â  diff = `${sign}${
                Math.floor(Math.abs(diffMin) / 60)}:${String(Math.abs(diffMin) % 60).padStart(2, '0')}`;
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  data.push([
Â  Â  Â  Â  Â  Â  formatDate(e.date),
Â  Â  Â  Â  Â  Â  e.type === 'Arbeit' ? e.start || '-' : '-',
Â  Â  Â  Â  Â  Â  e.type === 'Arbeit' ? e.end || '-' : '-',
Â  Â  Â  Â  Â  Â  e.type === 'Arbeit' ? e.pause || '0' : '-',
Â  Â  Â  Â  Â  Â  e.type,
Â  Â  Â  Â  Â  Â  e.hours || '0:00',
Â  Â  Â  Â  Â  Â  sollHours === '' ? '' : `${Math.floor(sollHours)}:${String(Math.round((sollHours % 1) * 60)).padStart(2, '0')}`,
Â  Â  Â  Â  Â  Â  diff
Â  Â  Â  Â  Â  ]);
Â  Â  Â  Â  });

Â  Â  Â  Â  // Tabelle einfÃ¼gen
Â  Â  Â  Â  doc.autoTable({
Â  Â  Â  Â  Â  head: [headers],
Â  Â  Â  Â  Â  body: data,
Â  Â  Â  Â  Â  startY: 25,
Â  Â  Â  Â  Â  margin: { horizontal: 10 },
Â  Â  Â  Â  Â  styles: {
Â  Â  Â  Â  Â  Â  fontSize: 8,
Â  Â  Â  Â  Â  Â  cellPadding: 2,
Â  Â  Â  Â  Â  Â  overflow: 'linebreak'
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  headStyles: {
Â  Â  Â  Â  Â  Â  fillColor: [52, 152, 219],
Â  Â  Â  Â  Â  Â  textColor: 255
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // Statistiken hinzufÃ¼gen
Â  Â  Â  Â  const finalY = doc.lastAutoTable.finalY + 15;
Â  Â  Â  Â  doc.setFontSize(12);
Â  Â  Â  Â  const oh = Math.floor(Math.abs(totalOvertimeMinutes) / 60);
Â  Â  Â  Â  const om = Math.abs(totalOvertimeMinutes) % 60;
Â  Â  Â  Â  const sign = totalOvertimeMinutes < 0 ? "-" : "";
Â  Â  Â  Â  const vacationTotal = parseInt(localStorage.getItem('vacationDays') || 24) + parseInt(localStorage.getItem('carryoverDays') || 0);
Â  Â  Â  Â  const vacationTaken = timeEntries.filter(e => e.type === 'Urlaub').length;
Â  Â  Â  Â  const sickDays = timeEntries.filter(e => e.type === 'Krank').length;

Â  Â  Â  Â  doc.text(`Ãœberstunden: ${sign}${oh}:${String(om).padStart(2, '0')}`, 14, finalY);
Â  Â  Â  Â  doc.text(`Urlaubstage (genommen/verfÃ¼gbar): ${vacationTaken}/${vacationTotal}`, 14, finalY + 10);
Â  Â  Â  Â  doc.text(`Krankheitstage: ${sickDays}`, 14, finalY + 20);

Â  Â  Â  Â  // PDF speichern
Â  Â  Â  Â  doc.save(`Monatsreport_${monthNames[parseInt(month)-1]}_${year}.pdf`);

Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('PDF-Export fehlgeschlagen:', error);
Â  Â  Â  Â  alert('Fehler beim PDF-Export: ' + error.message);
Â  Â  Â  }
Â  Â  }

Â  Â  // Backup exportieren
Â  Â  function exportBackup() {
Â  Â  Â  const data = {
Â  Â  Â  Â  entries: timeEntries,
Â  Â  Â  Â  settings: {
Â  Â  Â  Â  Â  workHours: localStorage.getItem('workHours') || 8,
Â  Â  Â  Â  Â  vacationDays: localStorage.getItem('vacationDays') || 24,
Â  Â  Â  Â  Â  carryoverDays: localStorage.getItem('carryoverDays') || 0,
Â  Â  Â  Â  Â  totalOvertimeMinutes: totalOvertimeMinutes
Â  Â  Â  Â  },
Â  Â  Â  Â  exported: new Date().toISOString()
Â  Â  Â  };
Â  Â  Â  const now = new Date().getTime();
Â  Â  Â  backupTimestamps.push(now);
Â  Â  Â  while (backupTimestamps.length > 2) backupTimestamps.shift();
Â  Â  Â  localStorage.setItem('backupTimestamps', JSON.stringify(backupTimestamps));
Â  Â  Â  download(`backup_zeiterfassung_${now}.json`, JSON.stringify(data, null, 2), 'application/json');
Â  Â  }

Â  Â  // Backup importieren
Â  Â  function handleImport(e) {
Â  Â  Â  const file = e.target.files[0];
Â  Â  Â  if (!file) return;
Â  Â  Â  const reader = new FileReader();
Â  Â  Â  reader.onload = function (event) {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const data = JSON.parse(event.target.result);
Â  Â  Â  Â  Â  if (!Array.isArray(data.entries)) throw new Error('UngÃ¼ltiges Format');

Â  Â  Â  Â  Â  if (confirm(`${data.entries.length} EintrÃ¤ge importieren? Vorherige Daten werden Ã¼berschrieben.`)) {
Â  Â  Â  Â  Â  Â  timeEntries = data.entries;
Â  Â  Â  Â  Â  Â  localStorage.setItem('timeEntries', JSON.stringify(timeEntries));

Â  Â  Â  Â  Â  Â  if (data.settings) {
Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('workHours', data.settings.workHours);
Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('vacationDays', data.settings.vacationDays);
Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('carryoverDays', data.settings.carryoverDays);
Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('totalOvertimeMinutes', data.settings.totalOvertimeMinutes);
Â  Â  Â  Â  Â  Â  Â  document.getElementById('work-hours').value = data.settings.workHours;
Â  Â  Â  Â  Â  Â  Â  document.getElementById('vacation-days-year').value = data.settings.vacationDays;
Â  Â  Â  Â  Â  Â  Â  document.getElementById('carryover-days').value = data.settings.carryoverDays;
Â  Â  Â  Â  Â  Â  Â  totalOvertimeMinutes = data.settings.totalOvertimeMinutes;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  loadEntries();
Â  Â  Â  Â  Â  Â  alert('Import erfolgreich.');
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  alert('Fehler beim Import: ' + err.message);
Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  Â  reader.readAsText(file);
Â  Â  }

Â  Â  // Ãœberstunden zurÃ¼cksetzen Funktion mit doppelter Warnung und Backup-Hinweis
Â  Â  function resetOvertime() {
Â  Â  Â  if (confirm('MÃ¶chten Sie wirklich alle Ãœberstunden zurÃ¼cksetzen? Diese Aktion kann nicht rÃ¼ckgÃ¤ngig gemacht werden.')) {
Â  Â  Â  Â  if (confirm('Sind Sie sicher? Bitte erstellen Sie vorher ein Backup Ihrer Daten!')) {
Â  Â  Â  Â  Â  localStorage.setItem('totalOvertimeMinutes', 0);
Â  Â  Â  Â  Â  totalOvertimeMinutes = 0;
Â  Â  Â  Â  Â  updateStats(totalOvertimeMinutes, timeEntries.filter(e => e.type === 'Urlaub').length, parseInt(localStorage.getItem('vacationDays') || 24) + parseInt(localStorage.getItem('carryoverDays') || 0), timeEntries.filter(e => e.type === 'Krank').length);
Â  Â  Â  Â  Â  alert('Ãœberstunden wurden zurÃ¼ckgesetzt.');
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  alert('Vorgang abgebrochen.');
Â  Â  Â  Â  }
Â  Â  Â  } else {
Â  Â  Â  Â  alert('Vorgang abgebrochen.');
Â  Â  Â  }
Â  Â  }

Â  Â  // Hilfsfunktionen
Â  Â  function formatDate(dateStr) {
Â  Â  Â  const [y, m, d] = dateStr.split('-');
Â  Â  Â  return `${d}.${m}.${y}`;
Â  Â  }

Â  Â  function isValidTime(time) {
Â  Â  Â  return /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(time);
Â  Â  }

Â  Â  function download(filename, content, type) {
Â  Â  Â  const blob = new Blob(["\uFEFF" + content], { type });
Â  Â  Â  const link = document.createElement('a');
Â  Â  Â  link.href = URL.createObjectURL(blob);
Â  Â  Â  link.download = filename;
Â  Â  Â  link.click();
Â  Â  Â  URL.revokeObjectURL(link.href);
Â  Â  }

Â  Â  function checkBackupReminder() {
Â  Â  Â  const last = backupTimestamps[backupTimestamps.length - 1] || 0;
Â  Â  Â  const now = new Date().getTime();
Â  Â  Â  const oneWeek = 7 * 24 * 60 * 60 * 1000;
Â  Â  Â  if (now - last > oneWeek) {
Â  Â  Â  Â  alert("Es ist Ã¼ber eine Woche seit dem letzten Backup vergangen. Bitte speichern Sie ein neues Backup.");
Â  Â  Â  }
Â  Â  }

Â  Â  // Event Listeners
Â  Â  document.getElementById('add-entry-btn').addEventListener('click', addTimeEntry);
Â  Â  document.getElementById('month').addEventListener('change', loadEntries);
Â  Â  workHoursInput.addEventListener('change', saveSettings);
Â  Â  vacationDaysYearInput.addEventListener('change', saveSettings);
Â  Â  carryoverDaysInput.addEventListener('change', saveSettings);
Â  Â  document.getElementById('export-csv-btn').addEventListener('click', exportCSV);
Â  Â  document.getElementById('export-pdf-btn').addEventListener('click', exportPDF);
Â  Â  document.getElementById('export-backup-btn').addEventListener('click', exportBackup);
Â  Â  document.getElementById('import-backup-btn').addEventListener('click', () => document.getElementById('import-file').click());
Â  Â  document.getElementById('import-file').addEventListener('change', handleImport);
Â  Â  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
Â  Â  document.getElementById('date').addEventListener('change', () => timeRangeDiv.style.display = 'none');
Â  Â  document.getElementById('type').addEventListener('change', (e) => {
Â  Â  Â  if (e.target.value !== 'Arbeit') {
Â  Â  Â  Â  timeRangeDiv.style.display = 'block';
Â  Â  Â  } else {
Â  Â  Â  Â  timeRangeDiv.style.display = 'none';
Â  Â  Â  }
Â  Â  });
Â  Â  addTimeRangeBtn.addEventListener('click', addTimeRange);
Â  Â  resetOvertimeBtn.addEventListener('click', resetOvertime);
Â  </script>

Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
Â  <script>
Â  Â  // Initialisierung fÃ¼r jsPDF
Â  Â  window.jspdf = window.jspdf || {};
Â  </script>
</body>
</html>
